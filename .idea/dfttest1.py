from signalprocessing import *
import math
samples = (0, 3278, 6506, 9627, 12605, 15376, 17915, 20163, 22103, 23690, 24908, 25735, 26157, 26169, 25768, 24969, 23765, 22207, 20279, 18053, 15525, 12769, 9801, 6686, 3464, 185, -3091, -6325, -9453, -12442, -15223, -17780, -20040, -22005, -23606, -24853, -25696, -26146, -26176, -25806, -25020, -23849, -22301, -20400, -18184, -15680, -12927, -9978, -6864, -3649, -374, 2908, 6141, 9282, 12274, 15073, 17640, 19921, 21902, 23525, 24792, 25659, 26131, 26186, 25838, 25074, 23928, 22396, 20519, 18318, 15826, 13095, 10144, 7049, 3832, 559, -2719, -5963, -9105, -12108, -14923, -17497, -19804, -21795, -23444, -24731, -25619, -26116, -26193, -25870, -25127, -24005, -22491, -20635, -18452, -15974, -13256, -10316, -7229, -4016, -747, 2534, 5781, 8929, 11944, 14766, 17360, 19680, 21690, 23363, 24663, 25584, 26095, 26203, 25896, 25183, 24076, 22589, 20748, 18585, 16121, 13417, 10489, 7406, 4202, 934, -2351, -5595, -8756, -11776, -14611, -17222, -19554, -21586, -23277, -24599, -25544, -26076, -26207, -25926, -25232, -24153, -22679, -20866, -18711, -16273, -13573, -10662, -7585, -4385, -1122, 2166, 5412, 8580, 11607, 14459, 17077, 19431, 21480, 23188, 24538, 25497, 26058, 26212, 25951, 25285, 24221, 22776, 20975, 18845, 16416, 13734, 10833, 7762, 4570, 1308, -1980, -5229, -8402, -11443, -14299, -16937, -19305, -21371, -23103, -24469, -25455, -26036, -26215, -25975, -25336, -24289, -22872, -21083, -18975, -16563, -13890, -11004, -7940, -4754, -1494, 1792, 5048, 8224, 11274, 14143, 16794, 19178, 21262, 23014, 24402, 25408, 26017, 26212, 26004, 25378, 24363, 22959, 21196, 19103, 16705, 14051, 11172, 8117, 4940, 1676, -1601, -4868, -8044, -11107, -13984, -16651, -19049, -21155, -22921, -24334, -25363, -25990, -26217, -26022, -25428, -24429, -23048, -21308, -19228, -16851, -14206, -11341, -8295, -5122, -1865, 1418, 4681, 7869, 10935, 13828, 16504, 18923, 21040, 22835, 24260, 25317, 25965, 26213, 26047, 25471, 24498, 23135, 21416, 19354, 16995, 14363, 11508, 8472, 5304, 2053, -1232, -4498, -7689, -10769, -13663, -16365, -18788, -20931, -22742, -24188, -25269, -25937, -26212, -26066, -25514, -24565, -23221, -21525, -19478, -17137, -14518, -11676, -8649, -5488, -2237, 1044, 4315, 7510, 10596, 13509, 16212, 18662, 20817, 22646, 24120, 25214, 25913, 26206, 26086, 25556, 24628, 23310, 21628, 19606, 17275, 14674, 11843, 8826, 5668, 2426, -861, -4128, -7331, -10426, -13348, -16065, -18531, -20702, -22552, -24046, -25163, -25883, -26201, -26103, -25598, -24691, -23395, -21732, -19730, -17414, -14831, -12007, -9002, -5852, -2608, 670, 3945, 7154, 10250, 13190, 15916, 18398, 20588, 22455, 23972, 25109, 25854, 26193, 26121, 25636, 24755, 23477, 21838, 19851, 17554, 14983, 12175, 9175, 6036, 2792, -482, -3763, -6971, -10080, -13027, -15768, -18265, -20471, -22359, -23894, -25057, -25821, -26186, -26134, -25677, -24813, -23562, -21939, -19972, -17694, -15135, -12340, -9351, -6214, -2983, 302, 3570, 6798, 9903, 12866, 15618, 18131, 20352, 22265, 23812, 25004, 25787, 26176, 26150, 25712, 24873, 23643, 22041, 20093, 17831, 15286, 12505, 9525, 6397, 3165, -110, -3391, -6612, -9734, -12700, -15471, -17990, -20241, -22158, -23741, -24941, -25757, -26164, -26161, -25749, -24932, -23722, -22143, -20211, -17967, -15440, -12667, -9699, -6578, -3350, -78, 3207, 6431, 9560, 12538, 15316, 17859, 20117, 22062, 23657, 24888, 25716, 26155, 26171, 25785, 24987, 23803, 22239, 20332, 18103, 15588, 12832, 9873, 6756, 3539, 259, -3017, -6250, -9388, -12370, -15169, -17718, -19999, -21958, -23579, -24824, -25685, -26137, -26184, -25815, -25045, -23879, -22339, -20449, -18237, -15739, -12993, -10046, -6937, -3724, -445, 2830, 6072, 9209, 12210, 15011, 17585, 19872, 21861, 23494, 24765, 25645, 26123, 26191, 25850, 25096, 23959, 22432, 20568, 18370, 15887, 13157, 10216, 7118, 3907, 636, -2649, -5886, -9038, -12041, -14860, -17443, -19755, -21752, -23413, -24702, -25608, -26106, -26198, -25879, -25151, -24033, -22531, -20680, -18504, -16036, -13316, -10390, -7296, -4094, -818, 2457, 5711, 8855, 11881, 14701, 17307, 19629, 21649, 23328, 24638, 25567, 26089, 26206, 25905, 25206, 24103, 22629, 20794, 18635, 16183, 13478, 10559, 7479, 4273, 1010, -2276, -5523, -8685, -11709, -14550, -17163, -19506, -21544, -23241, -24575, -25524, -26070, -26211, -25933, -25256, -24178, -22720, -20908, -18766, -16329, -13639, -10729, -7656, -4460, -1194, 2088, 5342, 8507, 11543, 14393, 17023, 19379, 21439, 23151, 24513, 25478, 26052, 26211, 25963, 25303, 24250, 22813, 21020, 18896, 16476, 13795, 10902, 7832, 4647, 1378, -1900, -5161, -8328, -11376, -14238, -16878, -19257, -21324, -23070, -24441, -25437, -26029, -26213, -25988, -25351, -24322, -22902, -21134, -19022, -16622, -13954, -11070, -8013, -4827, -1568, 1717, 4975, 8154, 11204, 14083, 16733, 19131, 21216, 22978, 24375, 25389, 26008, 26214, 26009, 25402, 24385, 22999, 21238, 19155, 16762, 14116, 11235, 8194, 5007, 1757, -1532, -4790, -7976, -11037, -13923, -16591, -19000, -21108, -22887, -24306, -25341, -25985, -26211, -26036, -25442, -24459, -23083, -21349, -19282, -16904, -14274, -11404, -8368, -5194, -1940, 1343, 4609, 7796, 10869, 13763, 16447, 18871, 20995, 22799, 24231, 25298, 25953, 26214, 26054, 25490, 24521, 23175, 21454, 19409, 17048, 14427, 11574, 8545, 5375, 2129, -1158, -4424, -7620, -10696, -13606, -16298, -18743, -20883, -22704, -24163, -25242, -25934, -26204, -26079, -25528, -24592, -23256, -21566, -19530, -17192, -14580, -11745, -8718, -5560, -2313, 972, 4237, 7443, 10523, 13449, 16151, 18610, 20772, 22606, 24094, 25190, 25906, 26199, 26096, 25572, 24653, 23346, 21668, 19657, 17330, 14736, 11911, 8894, 5744, 2497, -783, -4055, -7262, -10355, -13283, -16008, -18475, -20659, -22512, -24017, -25140, -25874, -26196, -26111, -25614, -24715, -23429, -21775, -19777, -17473, -14888, -12078, -9069, -5926, -2682, 594, 3875, 7076, 10189, 13117, 15863, 18341, 20543, 22418, 23938, 25090, 25840, 26192, 26124, 25655, 24775, 23514, 21877, 19901, 17609, 15044, 12241, 9246, 6107, 2869, -410, -3687, -6900, -10011, -12962, -15708, -18211, -20425, -22318, -23867, -25031, -25810, -26181, -26141, -25691, -24838, -23593, -21981, -20020, -17750, -15194, -12408, -9418, -6289, -3055, 224, 3499, 6724, 9836, 12799, 15560, 18073, 20310, 22220, 23786, 24977, 25777, 26169, 26157, 25724, 24901, 23670, 22085, 20139, 17886, 15348, 12569, 9596, 6467, 3242, -38, -3314, -6542, -9663, -12637, -15407, -17940, -20189, -22121, -23708, -24917, -25745, -26158, -26166, -25764, -24952, -23756, -22181, -20261, -18021, -15498, -12734, -9768, -6650, -3427, -148, 3129, 6360, 9491, 12469, 15260, 17800, 20072, 22019, 23627, 24862, 25703, 26151, 26173, 25799, 25010, 23832, 22282, 20377, 18157, 15649, 12896, 9942, 6829, 3612, 335, -2943, -6179, -9316, -12307, -15105, -17665, -19948, -21920, -23544, -24803, -25666, -26135, -26184, -25831, -25065, -23910, -22380, -20492, -18294, -15796, -13059, -10116, -7007, -3799, -520, 2757, 5997, 9141, 12142, 14952, 17526, 19829, 21813, 23466, 24736, 25634, 26114, 26196, 25860, 25120, 23986, 22475, 20611, 18423, 15950, 13217, 10287, 7191, 3978, 713, -2575, -5816, -8962, -11981, -14793, -17392, -19701, -21714, -23377, -24678, -25592, -26097, -26204, -25888, -25174, -24061, -22569, -20728, -18554, -16098, -13378, -10459, -7369, -4164, -899, 2390, 5630, 8793, 11806, 14648, 17242, 19586, 21602, 23296, 24614, 25548)
samples = normalize(samples)
identified_freq = identify_freq(samples=samples, samprate=44100,
                                                start_freq=note_to_hertz("A", accidental=None, octave=2),
                                                end_freq=note_to_hertz("A", accidental=None, octave=6),
                                                step_semitones=1, thres_cents=0.1)

print identified_freq
print hertz_to_note(identified_freq)
'''K = 19.5
for i in range(100):
    k = K + i * 0.01
    print k, freq_bin_at(k, samples), hertz_to_note(freq_bin_to_hertz(k, 44100, len(samples)))'''
